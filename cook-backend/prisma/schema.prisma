generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Role {
  id          Int      @id @default(autoincrement())
  codigo      String   @unique @db.VarChar(20)
  nombre      String   @unique @db.VarChar(50)
  descripcion String?  @db.Text
  permisos    String?  @db.LongText
  esActivo    Boolean? @default(true) @map("es_activo")
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp(0)
  usuarios    User[]

  @@map("roles")
}

model DocumentType {
  id               Int      @id @default(autoincrement())
  codigo           String   @unique @db.VarChar(10)
  nombre           String   @unique @db.VarChar(50)
  longitudMinima   Int      @default(8) @map("longitud_minima")
  longitudMaxima   Int      @default(11) @map("longitud_maxima")
  patronValidacion String?  @map("patron_validacion") @db.VarChar(100)
  esActivo         Boolean? @default(true) @map("es_activo")
  createdAt        DateTime @default(now()) @map("created_at") @db.Timestamp(0)
  usuarios         User[]

  @@map("tipos_documento")
}

model ClientPlan {
  id                     Int      @id @default(autoincrement())
  codigo                 String   @unique @db.VarChar(20)
  nombre                 String   @db.VarChar(50)
  descripcion            String?  @db.Text
  precioMensual          Decimal? @default(0.00) @map("precio_mensual") @db.Decimal(8, 2)
  precioAnual            Decimal? @map("precio_anual") @db.Decimal(10, 2)
  incluyeRecetas         Boolean? @default(false) @map("incluye_recetas")
  limiteIngredientes     Int?     @default(0) @map("limite_ingredientes")
  limiteRecetasFavoritas Int?     @default(0) @map("limite_recetas_favoritas")
  funcionalidades        String?  @db.LongText
  esActivo               Boolean? @default(true) @map("es_activo")
  ordenMostrar           Int?     @default(1) @map("orden_mostrar")
  createdAt              DateTime @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt              DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  clientes               Client[]

  @@map("planes_cliente")
}

model User {
  id                 Int                  @id @default(autoincrement())
  email              String               @unique @db.VarChar(255)
  passwordHash       String               @map("password_hash") @db.VarChar(255)
  rolId              Int                  @map("rol_id")
  tipoDocumentoId    Int                  @map("tipo_documento_id")
  numeroDocumento    String               @map("numero_documento") @db.VarChar(20)
  nombres            String               @db.VarChar(100)
  apellidos          String               @db.VarChar(100)
  telefono           String?              @db.VarChar(20)
  fechaNacimiento    DateTime?            @map("fecha_nacimiento") @db.Date
  genero             Gender?              @default(O)
  fotoPerfil         String?              @map("foto_perfil") @db.VarChar(500)
  emailVerificado    Boolean?             @default(false) @map("email_verificado")
  telefonoVerificado Boolean?             @default(false) @map("telefono_verificado")
  tokenVerificacion  String?              @map("token_verificacion") @db.VarChar(100)
  tokenRecuperacion  String?              @map("token_recuperacion") @db.VarChar(100)
  fechaTokenExpira   DateTime?            @map("fecha_token_expira") @db.Timestamp(0)
  intentosLogin      Int?                 @default(0) @map("intentos_login")
  bloqueadoHasta     DateTime?            @map("bloqueado_hasta") @db.Timestamp(0)
  aceptaTerminos     Boolean?             @default(false) @map("acepta_terminos")
  aceptaMarketing    Boolean?             @default(false) @map("acepta_marketing")
  esActivo           Boolean?             @default(true) @map("es_activo")
  ultimoAcceso       DateTime?            @map("ultimo_acceso") @db.Timestamp(0)
  ipUltimoAcceso     String?              @map("ip_ultimo_acceso") @db.VarChar(45)
  createdAt          DateTime             @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt          DateTime             @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  actividades        UserActivity[]
  cliente            Client?
  favoritos          Favorite[]
  listaCompras       ShoppingList[]
  notificaciones     Notification[]
  resenasRecetas     RecipeReview[]
  despensa           UserPantry[]
  recetasFavoritas   UserFavoriteRecipe[]
  rol                Role                 @relation(fields: [rolId], references: [id])
  tipoDocumento      DocumentType         @relation(fields: [tipoDocumentoId], references: [id])

  @@unique([tipoDocumentoId, numeroDocumento], name: "uk_documento")
  @@index([rolId], map: "usuarios_rol_id_fkey")
  @@map("usuarios")
}

model ProductCategory {
  id          Int       @id @default(autoincrement())
  nombre      String    @unique @db.VarChar(100)
  descripcion String?   @db.Text
  esActivo    Boolean   @default(true) @map("es_activo")
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")
  products    Product[]

  @@map("productos_categorias")
}

model Product {
  id          Int             @id @default(autoincrement())
  stock       Int             @default(0)
  createdAt   DateTime        @default(now()) @map("created_at")
  updatedAt   DateTime        @updatedAt @map("updated_at")
  atributos   Json?
  categoriaId Int             @map("categoria_id")
  descripcion String          @db.Text
  esActivo    Boolean         @default(true) @map("es_activo")
  imagenUrl   String?         @map("imagen_url") @db.VarChar(500)
  nombre      String          @db.VarChar(200)
  precio      Decimal?        @db.Decimal(10, 2)
  sku         String?         @unique @db.VarChar(100)
  categoria   ProductCategory @relation(fields: [categoriaId], references: [id])
  recipe      Recipe?

  @@index([categoriaId], map: "products_categoria_id_fkey")
  @@map("products")
}

model Client {
  id                       Int          @id @default(autoincrement())
  usuarioId                Int          @unique(map: "uk_cliente_usuario") @map("usuario_id")
  planClienteId            Int?         @default(1) @map("plan_cliente_id")
  fechaRegistro            DateTime     @map("fecha_registro") @db.Date
  fechaInicioPlan          DateTime?    @map("fecha_inicio_plan") @db.Date
  fechaFinPlan             DateTime?    @map("fecha_fin_plan") @db.Date
  preferenciasNotificacion String?      @map("preferencias_notificacion") @db.LongText
  limiteCredito            Decimal?     @default(0.00) @map("limite_credito") @db.Decimal(10, 2)
  creditoUsado             Decimal?     @default(0.00) @map("credito_usado") @db.Decimal(10, 2)
  puntosFidelidad          Int?         @default(0) @map("puntos_fidelidad")
  nivelCliente             ClientLevel? @default(BRONCE) @map("nivel_cliente")
  descuentoPersonalizado   Decimal?     @default(0.00) @map("descuento_personalizado") @db.Decimal(5, 2)
  notasInternas            String?      @map("notas_internas") @db.Text
  createdAt                DateTime     @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt                DateTime     @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  plan                     ClientPlan?  @relation(fields: [planClienteId], references: [id])
  usuario                  User         @relation(fields: [usuarioId], references: [id])

  @@index([planClienteId], map: "clientes_plan_cliente_id_fkey")
  @@map("clientes")
}

model RecipeCategory {
  id              Int      @id @default(autoincrement())
  nombre          String   @unique(map: "nombre") @db.VarChar(100)
  descripcion     String?  @db.Text
  icono           String?  @db.VarChar(50)
  color           String?  @db.VarChar(7)
  imagenCategoria String?  @map("imagen_categoria") @db.VarChar(500)
  ordenMostrar    Int?     @default(1) @map("orden_mostrar")
  esActivo        Boolean? @default(true) @map("es_activo")
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamp(0)
  recetas         Recipe[]

  @@map("categorias_receta")
}

model RecipeDifficulty {
  id          Int      @id @default(autoincrement())
  nivel       String   @unique(map: "nivel") @db.VarChar(20)
  descripcion String   @db.VarChar(100)
  orden       Int
  color       String?  @db.VarChar(7)
  icono       String?  @db.VarChar(50)
  recetas     Recipe[]

  @@map("dificultad_receta")
}

model MeasurementUnit {
  id                   Int                @id @default(autoincrement())
  codigo               String             @unique(map: "codigo") @db.VarChar(10)
  nombre               String             @unique(map: "nombre") @db.VarChar(50)
  abreviatura          String             @db.VarChar(10)
  tipo                 MeasurementType
  factorConversionBase Decimal?           @default(1.000000) @map("factor_conversion_base") @db.Decimal(10, 6)
  esActivo             Boolean?           @default(true) @map("es_activo")
  createdAt            DateTime           @default(now()) @map("created_at") @db.Timestamp(0)
  ingredientesMaestros MasterIngredient[]
  listaCompras         ShoppingList[]
  recetaIngredientes   RecipeIngredient[]
  despensaUsuarios     UserPantry[]

  @@map("unidades_medida")
}

model MasterIngredient {
  id                        Int                 @id @default(autoincrement())
  nombre                    String              @unique(map: "nombre") @db.VarChar(100)
  nombreAlternativo         String?             @map("nombre_alternativo") @db.VarChar(100)
  nombresRegionales         String?             @map("nombres_regionales") @db.LongText
  categoriaProductoId       Int?                @map("categoria_producto_id")
  unidadMedidaBaseId        Int                 @map("unidad_medida_base_id")
  caloriasPor100g           Decimal?            @map("calorias_por_100g") @db.Decimal(6, 2)
  proteinasPor100g          Decimal?            @map("proteinas_por_100g") @db.Decimal(6, 2)
  carbohidratosPor100g      Decimal?            @map("carbohidratos_por_100g") @db.Decimal(6, 2)
  grasasPor100g             Decimal?            @map("grasas_por_100g") @db.Decimal(6, 2)
  fibraPor100g              Decimal?            @map("fibra_por_100g") @db.Decimal(6, 2)
  descripcion               String?             @db.Text
  imagenUrl                 String?             @map("imagen_url") @db.VarChar(500)
  esPerecedero              Boolean?            @default(false) @map("es_perecedero")
  tiempoVidaDias            Int?                @map("tiempo_vida_dias")
  temperaturaAlmacenamiento StorageTemperature? @default(AMBIENTE) @map("temperatura_almacenamiento")
  esBasico                  Boolean?            @default(false) @map("es_basico")
  esCondimento              Boolean?            @default(false) @map("es_condimento")
  esEspecia                 Boolean?            @default(false) @map("es_especia")
  origenPais                String?             @map("origen_pais") @db.VarChar(50)
  temporadaDisponible       String?             @map("temporada_disponible") @db.LongText
  sustitutos                String?             @db.LongText
  alergenos                 String?             @db.VarChar(500)
  beneficiosSalud           String?             @map("beneficios_salud") @db.Text
  vecesUsado                Int?                @default(0) @map("veces_usado")
  esActivo                  Boolean?            @default(true) @map("es_activo")
  createdAt                 DateTime            @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt                 DateTime            @default(now()) @map("updated_at") @db.Timestamp(0)
  unidadMedidaBase          MeasurementUnit     @relation(fields: [unidadMedidaBaseId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_ingredientes_unidad")
  listaCompras              ShoppingList[]
  recetaIngredientes        RecipeIngredient[]
  despensaUsuarios          UserPantry[]

  @@index([esActivo], map: "idx_activo")
  @@index([esBasico], map: "idx_basico")
  @@index([categoriaProductoId], map: "idx_categoria")
  @@index([nombre], map: "idx_nombre")
  @@index([esPerecedero], map: "idx_perecedero")
  @@index([unidadMedidaBaseId], map: "idx_unidad")
  @@map("ingredientes_maestros")
}

model Recipe {
  id                   Int                  @id @default(autoincrement())
  nombre               String               @db.VarChar(200)
  descripcion          String?              @db.Text
  categoriaRecetaId    Int                  @map("categoria_receta_id")
  dificultadId         Int                  @map("dificultad_id")
  tiempoPreparacion    Int                  @map("tiempo_preparacion")
  tiempoCoccion        Int?                 @default(0) @map("tiempo_coccion")
  tiempoTotal          Int?                 @map("tiempo_total")
  porciones            Int?                 @default(1)
  caloriasAproximadas  Int?                 @map("calorias_aproximadas")
  costoAproximado      Decimal?             @map("costo_aproximado") @db.Decimal(8, 2)
  instrucciones        String               @db.LongText
  imagenPrincipal      String?              @map("imagen_principal") @db.VarChar(500)
  imagenesPasos        String?              @map("imagenes_pasos") @db.LongText
  videoUrl             String?              @map("video_url") @db.VarChar(500)
  tipsCocina           String?              @map("tips_cocina") @db.Text
  origenPais           String?              @default("Perú") @map("origen_pais") @db.VarChar(50)
  regionOrigen         String?              @map("region_origen") @db.VarChar(100)
  temporada            RecipeSeason?        @default(TODO_ANO)
  ocasion              String?              @db.LongText
  esVegetariana        Boolean?             @default(false) @map("es_vegetariana")
  esVegana             Boolean?             @default(false) @map("es_vegana")
  sinGluten            Boolean?             @default(false) @map("sin_gluten")
  sinLactosa           Boolean?             @default(false) @map("sin_lactosa")
  esSaludable          Boolean?             @default(false) @map("es_saludable")
  esTradicional        Boolean?             @default(false) @map("es_tradicional")
  popularidad          Int?                 @default(0)
  vecesPreparada       Int?                 @default(0) @map("veces_preparada")
  vecesFavorita        Int?                 @default(0) @map("veces_favorita")
  calificacionPromedio Decimal?             @default(0.00) @map("calificacion_promedio") @db.Decimal(3, 2)
  totalCalificaciones  Int?                 @default(0) @map("total_calificaciones")
  autorId              Int?                 @map("autor_id")
  esVerificada         Boolean?             @default(false) @map("es_verificada")
  fechaVerificacion    DateTime?            @map("fecha_verificacion") @db.Timestamp(0)
  esDestacada          Boolean?             @default(false) @map("es_destacada")
  esActivo             Boolean?             @default(true) @map("es_activo")
  createdAt            DateTime             @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt            DateTime             @default(now()) @map("updated_at") @db.Timestamp(0)
  productId            Int?                 @unique @map("product_id")
  listaCompras         ShoppingList[]
  ingredientes         RecipeIngredient[]
  resenas              RecipeReview[]
  categoria            RecipeCategory       @relation(fields: [categoriaRecetaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_recetas_categoria")
  dificultad           RecipeDifficulty     @relation(fields: [dificultadId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_recetas_dificultad")
  product              Product?             @relation(fields: [productId], references: [id], onDelete: Cascade)
  usuariosFavoritos    UserFavoriteRecipe[]

  @@index([esActivo], map: "idx_activo")
  @@index([autorId], map: "idx_autor")
  @@index([calificacionPromedio], map: "idx_calificacion")
  @@index([categoriaRecetaId], map: "idx_categoria")
  @@index([esDestacada], map: "idx_destacada")
  @@index([dificultadId], map: "idx_dificultad")
  @@index([esVegetariana, esVegana, sinGluten, sinLactosa], map: "idx_filtros")
  @@index([popularidad], map: "idx_popularidad")
  @@index([porciones], map: "idx_porciones")
  @@index([tiempoTotal], map: "idx_tiempo_total")
  @@map("recetas")
}

model RecipeIngredient {
  id                   Int              @id @default(autoincrement())
  recetaId             Int              @map("receta_id")
  ingredienteMaestroId Int              @map("ingrediente_maestro_id")
  cantidad             Decimal          @db.Decimal(8, 2)
  unidadMedidaId       Int              @map("unidad_medida_id")
  esOpcional           Boolean?         @default(false) @map("es_opcional")
  esPrincipal          Boolean?         @default(false) @map("es_principal")
  notas                String?          @db.VarChar(200)
  ordenAparicion       Int?             @default(1) @map("orden_aparicion")
  grupoIngrediente     String?          @map("grupo_ingrediente") @db.VarChar(50)
  costoAproximado      Decimal?         @map("costo_aproximado") @db.Decimal(6, 2)
  createdAt            DateTime         @default(now()) @map("created_at") @db.Timestamp(0)
  ingredienteMaestro   MasterIngredient @relation(fields: [ingredienteMaestroId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_receta_ingredientes_ingrediente")
  receta               Recipe           @relation(fields: [recetaId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_receta_ingredientes_receta")
  unidadMedida         MeasurementUnit  @relation(fields: [unidadMedidaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_receta_ingredientes_unidad")

  @@index([ingredienteMaestroId], map: "idx_ingrediente")
  @@index([ordenAparicion], map: "idx_orden")
  @@index([esPrincipal], map: "idx_principal")
  @@index([recetaId], map: "idx_receta")
  @@index([unidadMedidaId], map: "idx_unidad")
  @@map("receta_ingredientes")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model direcciones {
  id                    Int
  usuario_id            Int
  distrito_id           Int
  direccion_completa    String                      @db.Text
  referencia            String?                     @db.Text
  codigo_postal         String?                     @db.VarChar(10)
  latitud               Decimal?                    @db.Decimal(10, 8)
  longitud              Decimal?                    @db.Decimal(11, 8)
  es_principal          Boolean?                    @default(false)
  tipo_direccion        direcciones_tipo_direccion? @default(CASA)
  nombre_contacto       String?                     @db.VarChar(100)
  telefono_contacto     String?                     @db.VarChar(20)
  instrucciones_entrega String?                     @db.Text
  es_activo             Boolean?                    @default(true)
  created_at            DateTime                    @default(now()) @db.Timestamp(0)
  updated_at            DateTime                    @default(now()) @db.Timestamp(0)

  @@ignore
}

model UserFavoriteRecipe {
  id        Int      @id @default(autoincrement())
  usuarioId Int      @map("usuario_id")
  recetaId  Int      @map("receta_id")
  createdAt DateTime @default(now()) @map("created_at")
  receta    Recipe   @relation(fields: [recetaId], references: [id], onDelete: Cascade)
  usuario   User     @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([usuarioId, recetaId], name: "uk_usuario_receta")
  @@index([usuarioId], map: "idx_usuario")
  @@index([recetaId], map: "idx_receta")
  @@index([createdAt], map: "idx_fecha")
  @@map("usuario_recetas_favoritas")
}

model UserPantry {
  id                   Int              @id @default(autoincrement())
  usuarioId            Int              @map("usuario_id")
  ingredienteMaestroId Int              @map("ingrediente_maestro_id")
  cantidad             Decimal          @db.Decimal(8, 2)
  unidadMedidaId       Int              @map("unidad_medida_id")
  fechaVencimiento     DateTime?        @map("fecha_vencimiento") @db.Date
  fechaCompra          DateTime?        @map("fecha_compra") @db.Date
  notas                String?          @db.VarChar(200)
  esActivo             Boolean          @default(true) @map("es_activo")
  createdAt            DateTime         @default(now()) @map("created_at")
  updatedAt            DateTime         @default(now()) @updatedAt @map("updated_at")
  ingredienteMaestro   MasterIngredient @relation(fields: [ingredienteMaestroId], references: [id])
  unidadMedida         MeasurementUnit  @relation(fields: [unidadMedidaId], references: [id])
  usuario              User             @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([usuarioId, ingredienteMaestroId], name: "uk_usuario_ingrediente")
  @@index([usuarioId], map: "idx_usuario_despensa")
  @@index([ingredienteMaestroId], map: "idx_ingrediente_despensa")
  @@index([fechaVencimiento], map: "idx_vencimiento")
  @@index([unidadMedidaId], map: "usuario_despensa_unidad_medida_id_fkey")
  @@map("usuario_despensa")
}

model RecipeReview {
  id           Int      @id @default(autoincrement())
  usuarioId    Int      @map("usuario_id")
  recetaId     Int      @map("receta_id")
  calificacion Int      @db.TinyInt
  comentario   String?  @db.Text
  tituloResena String?  @map("titulo_resena") @db.VarChar(200)
  esVerificado Boolean  @default(false) @map("es_verificado")
  esReportado  Boolean  @default(false) @map("es_reportado")
  meGusta      Int      @default(0) @map("me_gusta")
  esUtil       Int      @default(0) @map("es_util")
  imagenes     String?  @db.LongText
  esActivo     Boolean  @default(true) @map("es_activo")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  receta       Recipe   @relation(fields: [recetaId], references: [id], onDelete: Cascade)
  usuario      User     @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([usuarioId, recetaId], name: "uk_usuario_receta_review")
  @@index([usuarioId], map: "idx_usuario_review")
  @@index([recetaId], map: "idx_receta_review")
  @@index([calificacion], map: "idx_calificacion_review")
  @@index([createdAt], map: "idx_fecha_review")
  @@index([esActivo], map: "idx_activo_review")
  @@map("receta_resenas")
}

model ShoppingList {
  id                   Int              @id @default(autoincrement())
  usuarioId            Int              @map("usuario_id")
  ingredienteMaestroId Int              @map("ingrediente_maestro_id")
  cantidad             Decimal          @db.Decimal(8, 2)
  unidadMedidaId       Int              @map("unidad_medida_id")
  recetaId             Int?             @map("receta_id")
  esComprado           Boolean          @default(false) @map("es_comprado")
  fechaCompra          DateTime?        @map("fecha_compra") @db.Timestamp(0)
  prioridad            Int              @default(1)
  notas                String?          @db.VarChar(200)
  precioEstimado       Decimal?         @map("precio_estimado") @db.Decimal(8, 2)
  tiendaSugerida       String?          @map("tienda_sugerida") @db.VarChar(100)
  urlTienda            String?          @map("url_tienda") @db.VarChar(500)
  esActivo             Boolean          @default(true) @map("es_activo")
  createdAt            DateTime         @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt            DateTime         @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  ingredienteMaestro   MasterIngredient @relation(fields: [ingredienteMaestroId], references: [id])
  receta               Recipe?          @relation(fields: [recetaId], references: [id])
  unidadMedida         MeasurementUnit  @relation(fields: [unidadMedidaId], references: [id])
  usuario              User             @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@index([usuarioId], map: "idx_usuario_lista")
  @@index([ingredienteMaestroId], map: "idx_ingrediente_lista")
  @@index([esComprado], map: "idx_comprado")
  @@index([prioridad], map: "idx_prioridad")
  @@index([createdAt], map: "idx_fecha_lista")
  @@index([recetaId], map: "lista_compras_receta_id_fkey")
  @@index([unidadMedidaId], map: "lista_compras_unidad_medida_id_fkey")
  @@map("lista_compras")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model planes_negocio {
  id                        Int
  codigo                    String                        @db.VarChar(20)
  nombre                    String                        @db.VarChar(50)
  descripcion               String?                       @db.Text
  precio_mensual            Decimal?                      @default(0.00) @db.Decimal(8, 2)
  precio_anual              Decimal?                      @db.Decimal(10, 2)
  limite_productos          Int?                          @default(0)
  incluye_estadisticas      Boolean?                      @default(false)
  incluye_marketing         Boolean?                      @default(false)
  incluye_facturacion_sunat Boolean?                      @default(false)
  soporte_nivel             planes_negocio_soporte_nivel? @default(EMAIL)
  funcionalidades           String?                       @db.LongText
  es_activo                 Boolean?                      @default(true)
  orden_mostrar             Int?                          @default(1)
  created_at                DateTime                      @default(now()) @db.Timestamp(0)
  updated_at                DateTime                      @default(now()) @db.Timestamp(0)

  @@ignore
}

model Favorite {
  id           Int          @id @default(autoincrement())
  usuarioId    Int          @map("usuario_id")
  tipo         FavoriteType
  referenciaId Int          @map("referencia_id")
  esActivo     Boolean      @default(true) @map("es_activo")
  createdAt    DateTime     @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt    DateTime     @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  usuario      User         @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([usuarioId, tipo, referenciaId, esActivo], name: "unique_favorito")
  @@index([usuarioId], map: "idx_usuario_favorito")
  @@index([tipo], map: "idx_tipo_favorito")
  @@index([referenciaId], map: "idx_referencia_favorito")
  @@index([createdAt], map: "idx_fecha_favorito")
  @@index([usuarioId, tipo, esActivo], map: "idx_usuario_tipo_activo")
  @@map("favoritos")
}

model Notification {
  id              Int                  @id @default(autoincrement())
  usuarioId       Int                  @map("usuario_id")
  titulo          String               @db.VarChar(200)
  mensaje         String               @db.Text
  tipo            NotificationType
  leido           Boolean              @default(false)
  fechaEnvio      DateTime             @default(now()) @map("fecha_envio") @db.Timestamp(0)
  fechaLectura    DateTime?            @map("fecha_lectura") @db.Timestamp(0)
  prioridad       NotificationPriority @default(NORMAL)
  programada      Boolean              @default(false)
  fechaProgramada DateTime?            @map("fecha_programada") @db.Timestamp(0)
  referenciaId    Int?                 @map("referencia_id")
  referenciaUrl   String?              @map("referencia_url") @db.VarChar(500)
  icono           String?              @db.VarChar(50)
  esActivo        Boolean              @default(true) @map("es_activo")
  createdAt       DateTime             @default(now()) @map("created_at") @db.Timestamp(0)
  updatedAt       DateTime             @default(now()) @updatedAt @map("updated_at") @db.Timestamp(0)
  usuario         User                 @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@index([usuarioId], map: "idx_usuario_notificacion")
  @@index([tipo], map: "idx_tipo_notificacion")
  @@index([leido], map: "idx_leido_notificacion")
  @@index([fechaEnvio], map: "idx_fecha_envio")
  @@index([programada, fechaProgramada], map: "idx_programada")
  @@index([usuarioId, leido, esActivo], map: "idx_usuario_leido_activo")
  @@map("notificaciones")
}

model UserActivity {
  id             Int          @id @default(autoincrement())
  usuarioId      Int          @map("usuario_id")
  tipo           ActivityType
  descripcion    String       @db.VarChar(500)
  referenciaId   Int?         @map("referencia_id")
  referenciaTipo String?      @map("referencia_tipo") @db.VarChar(50)
  metadata       Json?
  fecha          DateTime     @default(now()) @db.Timestamp(0)
  esActivo       Boolean      @default(true) @map("es_activo")
  createdAt      DateTime     @default(now()) @map("created_at") @db.Timestamp(0)
  usuario        User         @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@index([usuarioId], map: "idx_usuario_actividad")
  @@index([tipo], map: "idx_tipo_actividad")
  @@index([fecha], map: "idx_fecha_actividad")
  @@index([usuarioId, tipo, fecha], map: "idx_usuario_tipo_fecha")
  @@index([usuarioId, esActivo], map: "idx_usuario_activo")
  @@map("actividades_usuario")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model celulares {
  id                          Int                         @id @default(autoincrement())
  item_id                     Int                         @unique(map: "item_id")
  marca_id                    Int
  sistema_operativo_id        Int
  gama_id                     Int
  modelo                      String                      @db.VarChar(100)
  fecha_lanzamiento           DateTime?                   @db.Date
  pantalla_tamano_pulgadas    Decimal                     @db.Decimal(3, 1)
  pantalla_tipo               String?                     @db.VarChar(50)
  pantalla_resolucion         String?                     @db.VarChar(50)
  procesador_nombre           String?                     @db.VarChar(100)
  memoria_ram_gb              Int
  almacenamiento_interno_gb   Int
  bateria_capacidad_mah       Int
  carga_rapida_watts          Int?
  peso_gramos                 Int?
  conectividad_5g             Boolean?                    @default(false)
  resistencia_agua_ip         String?                     @db.VarChar(10)
  celular_gamas               celular_gamas               @relation(fields: [gama_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_celular_gama")
  items                       items                       @relation(fields: [item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_celulares_item")
  celular_marcas              celular_marcas              @relation(fields: [marca_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_celular_marca")
  celular_sistemas_operativos celular_sistemas_operativos @relation(fields: [sistema_operativo_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_celular_so")

  @@index([gama_id], map: "fk_celular_gama")
  @@index([marca_id], map: "fk_celular_marca")
  @@index([sistema_operativo_id], map: "fk_celular_so")
}

model items {
  id                    Int                     @id @default(autoincrement())
  nombre                String                  @db.VarChar(255)
  descripcion           String?                 @db.Text
  imagen_principal_url  String?                 @db.VarChar(500)
  es_activo             Boolean                 @default(true)
  fecha_creacion        DateTime                @default(now()) @db.Timestamp(0)
  fecha_actualizacion   DateTime                @default(now()) @db.Timestamp(0)
  celular_camaras       celular_camaras[]
  celulares             celulares?
  deporte_variaciones   deporte_variaciones[]
  deportes_equipamiento deportes_equipamiento?
  lugar_horarios        lugar_horarios[]
  lugar_tiene_servicios lugar_tiene_servicios[]
  lugares               lugares?
  torta_variaciones     torta_variaciones[]
  tortas                tortas?

  @@index([nombre], map: "idx_nombre")
}

model celular_camaras {
  id                    Int                 @id @default(autoincrement())
  celular_item_id       Int
  tipo_lente_id         Int
  megapixeles           Decimal             @db.Decimal(5, 1)
  apertura              Decimal?            @db.Decimal(3, 1)
  estabilizacion_optica Boolean?            @default(false)
  items                 items               @relation(fields: [celular_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_camara_celular_item")
  celular_tipos_lente   celular_tipos_lente @relation(fields: [tipo_lente_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_camara_tipo_lente")

  @@unique([celular_item_id, tipo_lente_id], map: "idx_celular_lente_unico")
  @@index([tipo_lente_id], map: "fk_camara_tipo_lente")
}

model celular_gamas {
  id          Int         @id @default(autoincrement())
  gama        String      @unique(map: "gama") @db.VarChar(50)
  descripcion String?     @db.VarChar(255)
  celulares   celulares[]
}

model celular_marcas {
  id          Int         @id @default(autoincrement())
  nombre      String      @unique(map: "nombre") @db.VarChar(100)
  pais_origen String?     @db.VarChar(100)
  logo_url    String?     @db.VarChar(500)
  celulares   celulares[]
}

model celular_sistemas_operativos {
  id             Int         @id @default(autoincrement())
  nombre         String      @unique(map: "nombre") @db.VarChar(100)
  version_actual String?     @db.VarChar(20)
  celulares      celulares[]
}

model celular_tipos_lente {
  id              Int               @id @default(autoincrement())
  tipo            String            @unique(map: "tipo") @db.VarChar(50)
  celular_camaras celular_camaras[]
}

model torta_coberturas {
  id     Int      @id @default(autoincrement())
  nombre String   @unique(map: "nombre") @db.VarChar(100)
  tortas tortas[]
}

model torta_ocasiones {
  id     Int      @id @default(autoincrement())
  nombre String   @unique(map: "nombre") @db.VarChar(100)
  tortas tortas[]
}

model torta_rellenos {
  id     Int      @id @default(autoincrement())
  nombre String   @unique(map: "nombre") @db.VarChar(100)
  tortas tortas[]
}

model torta_sabores {
  id     Int      @id @default(autoincrement())
  nombre String   @unique(map: "nombre") @db.VarChar(100)
  tortas tortas[]
}

model torta_variaciones {
  id                 Int     @id @default(autoincrement())
  torta_item_id      Int
  descripcion_tamano String  @db.VarChar(100)
  porciones_aprox    Int
  precio_usd         Decimal @db.Decimal(10, 2)
  items              items   @relation(fields: [torta_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_variacion_torta_item")

  @@unique([torta_item_id, descripcion_tamano], map: "idx_torta_tamano_unico")
}

model tortas {
  id                       Int              @id @default(autoincrement())
  item_id                  Int              @unique(map: "item_id")
  sabor_principal_id       Int
  relleno_principal_id     Int
  cobertura_id             Int
  ocasion_sugerida_id      Int?
  vendedor_o_pasteleria    String?          @db.VarChar(150)
  es_personalizable        Boolean?         @default(false)
  tiempo_preparacion_horas Int?             @default(24)
  alergenos                String?          @db.VarChar(255)
  torta_coberturas         torta_coberturas @relation(fields: [cobertura_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_torta_cobertura")
  items                    items            @relation(fields: [item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_torta_item")
  torta_ocasiones          torta_ocasiones? @relation(fields: [ocasion_sugerida_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_torta_ocasion")
  torta_rellenos           torta_rellenos   @relation(fields: [relleno_principal_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_torta_relleno")
  torta_sabores            torta_sabores    @relation(fields: [sabor_principal_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_torta_sabor")

  @@index([cobertura_id], map: "fk_torta_cobertura")
  @@index([ocasion_sugerida_id], map: "fk_torta_ocasion")
  @@index([relleno_principal_id], map: "fk_torta_relleno")
  @@index([sabor_principal_id], map: "fk_torta_sabor")
}

model lugar_horarios {
  id            Int                       @id @default(autoincrement())
  lugar_item_id Int
  dia_semana    lugar_horarios_dia_semana
  hora_apertura DateTime                  @db.Time(0)
  hora_cierre   DateTime                  @db.Time(0)
  items         items                     @relation(fields: [lugar_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_horario_lugar_item")

  @@unique([lugar_item_id, dia_semana], map: "idx_lugar_dia_unico")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model lugar_rangos_precio {
  id          Int       @id @default(autoincrement())
  simbolo     String    @unique(map: "simbolo") @db.VarChar(5)
  descripcion String    @db.VarChar(100)
  lugares     lugares[]
}

model lugar_servicios {
  id                    Int                     @id @default(autoincrement())
  nombre                String                  @unique(map: "nombre") @db.VarChar(100)
  icono                 String?                 @db.VarChar(50)
  lugar_tiene_servicios lugar_tiene_servicios[]
}

model lugar_tiene_servicios {
  lugar_item_id   Int
  servicio_id     Int
  items           items           @relation(fields: [lugar_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_lts_lugar_item")
  lugar_servicios lugar_servicios @relation(fields: [servicio_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_lts_servicio")

  @@id([lugar_item_id, servicio_id])
  @@index([servicio_id], map: "fk_lts_servicio")
}

model lugar_tipos {
  id      Int       @id @default(autoincrement())
  nombre  String    @unique(map: "nombre") @db.VarChar(100)
  icono   String?   @db.VarChar(50)
  lugares lugares[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model lugares {
  id                  Int                  @id @default(autoincrement())
  item_id             Int                  @unique(map: "item_id")
  lugar_tipo_id       Int
  rango_precio_id     Int?
  direccion           String               @db.VarChar(255)
  ciudad              String               @db.VarChar(100)
  pais                String               @db.VarChar(100)
  latitud             Decimal              @db.Decimal(10, 8)
  longitud            Decimal              @db.Decimal(11, 8)
  telefono            String?              @db.VarChar(20)
  sitio_web           String?              @db.VarChar(255)
  items               items                @relation(fields: [item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_lugar_item")
  lugar_rangos_precio lugar_rangos_precio? @relation(fields: [rango_precio_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_lugar_rango_precio")
  lugar_tipos         lugar_tipos          @relation(fields: [lugar_tipo_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_lugar_tipo")

  @@index([rango_precio_id], map: "fk_lugar_rango_precio")
  @@index([lugar_tipo_id], map: "fk_lugar_tipo")
}

model deporte_equipamiento_tipos {
  id                    Int                     @id @default(autoincrement())
  nombre                String                  @unique(map: "nombre") @db.VarChar(100)
  deportes_equipamiento deportes_equipamiento[]
}

model deporte_marcas {
  id                    Int                     @id @default(autoincrement())
  nombre                String                  @unique(map: "nombre") @db.VarChar(100)
  logo_url              String?                 @db.VarChar(500)
  deportes_equipamiento deportes_equipamiento[]
}

model deporte_tipos {
  id                    Int                     @id @default(autoincrement())
  nombre                String                  @unique(map: "nombre") @db.VarChar(100)
  icono                 String?                 @db.VarChar(50)
  deportes_equipamiento deportes_equipamiento[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model deporte_variaciones {
  id                   Int     @id @default(autoincrement())
  equipamiento_item_id Int
  talla                String  @db.VarChar(20)
  color                String  @db.VarChar(50)
  precio_usd           Decimal @db.Decimal(10, 2)
  sku                  String? @unique(map: "sku") @db.VarChar(50)
  stock                Int?    @default(0)
  items                items   @relation(fields: [equipamiento_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_variacion_deporte_item")

  @@unique([equipamiento_item_id, talla, color], map: "idx_deporte_variacion_unica")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model deportes_equipamiento {
  id                         Int                          @id @default(autoincrement())
  item_id                    Int                          @unique(map: "item_id")
  marca_id                   Int
  deporte_tipo_id            Int
  equipamiento_tipo_id       Int
  genero                     deportes_equipamiento_genero
  material_principal         String?                      @db.VarChar(100)
  coleccion                  String?                      @db.VarChar(100)
  deporte_equipamiento_tipos deporte_equipamiento_tipos   @relation(fields: [equipamiento_tipo_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_deporte_equip_tipo")
  items                      items                        @relation(fields: [item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_deporte_item")
  deporte_marcas             deporte_marcas               @relation(fields: [marca_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_deporte_marca")
  deporte_tipos              deporte_tipos                @relation(fields: [deporte_tipo_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_deporte_tipo")

  @@index([equipamiento_tipo_id], map: "fk_deporte_equip_tipo")
  @@index([marca_id], map: "fk_deporte_marca")
  @@index([deporte_tipo_id], map: "fk_deporte_tipo")
}

enum Gender {
  M
  F
  O
}

enum ClientLevel {
  BRONCE
  PLATA
  ORO
  PLATINO
}

enum MeasurementType {
  PESO
  VOLUMEN
  LONGITUD
  UNIDAD
  TIEMPO
}

enum StorageTemperature {
  AMBIENTE
  REFRIGERADO
  CONGELADO
}

enum RecipeSeason {
  VERANO
  OTONO     @map("OTOÑO")
  INVIERNO
  PRIMAVERA
  TODO_ANO  @map("TODO_AÑO")
}

enum direcciones_tipo_direccion {
  CASA
  TRABAJO
  NEGOCIO
  OTRO
}

enum planes_negocio_soporte_nivel {
  EMAIL
  TELEFONO
  CONSULTOR
}

enum FavoriteType {
  receta
  producto
  ingrediente
}

enum NotificationType {
  sistema
  receta
  ingrediente
  compra
  recordatorio
  promocion
  resena       @map("reseña")
  favorito
  vencimiento
}

enum NotificationPriority {
  BAJA
  NORMAL
  ALTA
  URGENTE
}

enum ActivityType {
  RECETA_VISTA
  RECETA_PREPARADA
  COMPRA_REALIZADA
  RESENA_PUBLICADA   @map("RESEÑA_PUBLICADA")
  FAVORITO_AGREGADO
  FAVORITO_ELIMINADO
  LOGIN
  LOGOUT
  PERFIL_ACTUALIZADO
  LISTA_CREADA
}

enum lugar_horarios_dia_semana {
  LUNES
  MARTES
  MIERCOLES
  JUEVES
  VIERNES
  SABADO
  DOMINGO
}

enum deportes_equipamiento_genero {
  HOMBRE
  MUJER
  UNISEX
  NI_OS  @map("NIÑOS")
}
